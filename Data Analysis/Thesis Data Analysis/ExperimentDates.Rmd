---
title: "Experiment Dates"
author: "Ashley"
date: "2023-03-30"
output: html_document
---

```{r}
if (!require("pacman")) install.packages("pacman") 
pacman::p_load(flextable, officer, stringr, ggplot2, stringr, gridExtra, ggpubr, Rmisc, FSA, rcompanion, RColorBrewer, dplyr, vegan, nparcomp, RVAideMemoire, MANOVA.RM, pairwiseAdonis, PMCMR, PMCMRplus, patchwork, plyr, gdata,paletteer, RColorBrewer, devtools, ochRe, rstatix, lmer4, lmerTest, glmmTMB,car,broom,emmeans, lubridate)
library(lubridate)
```

```{r}
ExperimentDates <- read.xls("ExperimentDates.xlsx")
ExperimentDates
```

```{r}
#ExperimentDates %>% mutate(Date=factor(Date)) 
 #filter(!is.na(Measurement))
```

#as.factor(ExperimentDates$Date)
startTime <- as.Date("2021-09-22")
endTime <- as.Date("2021-12-01")
start.end <- c(startTime,endTime)
start.end
ExperimentDates$Date

```{r}
#show(ExperimentDates$Measurement)
```
limits =as.Date(c("2021-09-22", "2021-12-01"), format ="%y-%m-%d")
#, Measurement != "NA"

```{r}
#as.character(ExperimentDates$Time)
```
ActiveProportionData$ExperimentTime <- factor(ActiveProportionData$ExperimentTime, levels =c("PreTreatment", "DuringTreatment", "PostTreatment"), labels=c("Pre Treatment", "During Treatment", "Post Treatment"))

```{r}
ExperimentDates$Time <-factor(ExperimentDates$Time, levels =c("Pre",  "During Treatment", "Post Treatment"), labels =c(" ", "During Treatment", "Post Treatment"))
```

, expand = (c(5,0))
```{r}
ExperimentDatePlot <- ggplot(data=(ExperimentDates), aes(x=as.Date(Date),y= Measurement, group=Measurement, color=Measurement)) +

#scale_x_date(date_labels ="%B,%d") +
 #xlim(as.Date(c("2021-09-22", "2021-12-01"), format="%y-%m- %d")) 
    annotate(geom="rect",xmin=as.Date("2021-09-23"),xmax=as.Date("2021-10-23"), ymin=-Inf,ymax=Inf, alpha=0.2) +
  annotate(geom="text",x=as.Date("2021-10-08"), y= 5.4, label="During Treatment", size=6) +
  # facet_grid(.~Time, scales= "free_x", space="free") +
  geom_point(size=5) +
  scale_x_date(limits =as.Date(c("2021-09-22", "2021-12-01"), format ="%y-%m-%d"), breaks=("2 day"), date_labels ="%b %d", expand=c(0.01,0.5)) +
 
scale_y_discrete(limits=c("Ambient Nutrients Only", "All Nutrients", "Surface Area", "Linear Progression", "Disease Prevalence")) +
  #facet_wrap(~Time, scales="free", ncol=1) +
  #geom_rect(aes(xmin="Sep 22", xmax="Dc 01"), data=ExperimentDates) +
  
 labs(y="Type of Measurement", x = "2021 Measurement Date") +
 
  theme(panel.grid.major = element_line(linewidth = 0.5, linetype = 'solid', colour = "white"),
        panel.background = element_rect(fill = '#F5F5F5', color="gray"),
        panel.spacing =unit(0.1,'lines'),
        plot.title = element_text(size = 17, face="bold", margin = margin(10,0,10,0)),
        axis.line = element_line(colour = "black"),
        axis.ticks = element_line(color="black"),
        text = element_text(size=19, color="black"), 
        axis.text.x=element_text(angle = 45, hjust = 1,size=14, color="black"),
        axis.text.y=element_text(size=16, color="black"), 
        legend.position="none")
        #legend.key = element_blank(),
         # legend.justification = c(1,0), legend.position = c(1,0))
 ExperimentDatePlot
ggsave("Figures/ExperimentDates.Graph.png", plot = ExperimentDatePlot, height = 9, width = 16, units = 'in', dpi = 600)
```

